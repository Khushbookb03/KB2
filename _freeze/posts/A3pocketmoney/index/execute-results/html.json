{
  "hash": "076f67a1b1c4fe7b7220c930620dba66",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A3pocketmoney\"\nauthor: \"Khushboo\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(broom)\nlibrary(crosstable)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'crosstable'\n\nThe following object is masked from 'package:purrr':\n\n    compact\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(knitr)\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_Money <- read_csv(\"C:/Users/khush/Downloads/Pocket Money.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 82 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Name, Gender\ndbl (2): Sr no, Money_spent\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nPocket_Money\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 82 × 4\n   `Sr no` Name     Gender Money_spent\n     <dbl> <chr>    <chr>        <dbl>\n 1       1 Aagam    Male           150\n 2       2 Aakash   Male           240\n 3       3 Aarushi  Female         382\n 4       4 Abheeta  Female          60\n 5       5 Adithya  Male            68\n 6       6 Aditya   Male           300\n 7       7 Akanksha Female         270\n 8       8 Amruta   Female         190\n 9       9 Anaaya   Female         300\n10      10 Anish    Male             0\n# ℹ 72 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(Pocket_Money)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 82\nColumns: 4\n$ `Sr no`     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…\n$ Name        <chr> \"Aagam\", \"Aakash\", \"Aarushi\", \"Abheeta\", \"Adithya\", \"Adity…\n$ Gender      <chr> \"Male\", \"Male\", \"Female\", \"Female\", \"Male\", \"Male\", \"Femal…\n$ Money_spent <dbl> 150, 240, 382, 60, 68, 300, 270, 190, 300, 0, 250, 85, 700…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(Pocket_Money)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n    name     class levels  n missing\n1   Name character     82 82       0\n2 Gender character      2 82       0\n                                   distribution\n1 Aagam (1.2%), Aakash (1.2%) ...              \n2 Female (50%), Male (50%)                     \n\nquantitative variables:  \n         name   class min     Q1 median     Q3   max     mean         sd  n\n1       Sr no numeric   1  21.25   41.5  61.75    82  41.5000   23.81526 82\n2 Money_spent numeric   0 100.00  264.5 596.25 13000 720.9634 1835.72169 82\n  missing\n1       0\n2       0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(Pocket_Money)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |             |\n|:------------------------|:------------|\n|Name                     |Pocket_Money |\n|Number of rows           |82           |\n|Number of columns        |4            |\n|_______________________  |             |\n|Column type frequency:   |             |\n|character                |2            |\n|numeric                  |2            |\n|________________________ |             |\n|Group variables          |None         |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Name          |         0|             1|   3|  12|     0|       82|          0|\n|Gender        |         0|             1|   4|   6|     0|        2|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|      sd| p0|    p25|   p50|    p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-------:|--:|------:|-----:|------:|-----:|:-----|\n|Sr no         |         0|             1|  41.50|   23.82|  1|  21.25|  41.5|  61.75|    82|▇▇▇▇▇ |\n|Money_spent   |         0|             1| 720.96| 1835.72|  0| 100.00| 264.5| 596.25| 13000|▇▁▁▁▁ |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_Money2 <- Pocket_Money %>%\n    mutate(\n        Preferance = case_when(\n            Money_spent > 500 ~ \"High Spender\",\n            Money_spent > 200 & Money_spent <= 500 ~ \"Medium Spender\",\n            TRUE ~ \"Low Spender\"\n        )\n    )\n\n# Convert 'Preferance' to a factor\nPocket_Money2 <- Pocket_Money2 %>%\n    mutate(\n        Preferance = as_factor(Preferance)\n    )\n\nglimpse(Pocket_Money2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 82\nColumns: 5\n$ `Sr no`     <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…\n$ Name        <chr> \"Aagam\", \"Aakash\", \"Aarushi\", \"Abheeta\", \"Adithya\", \"Adity…\n$ Gender      <chr> \"Male\", \"Male\", \"Female\", \"Female\", \"Male\", \"Male\", \"Femal…\n$ Money_spent <dbl> 150, 240, 382, 60, 68, 300, 270, 190, 300, 0, 250, 85, 700…\n$ Preferance  <fct> Low Spender, Medium Spender, Medium Spender, Low Spender, …\n```\n\n\n:::\n:::\n\n\n\n#### *Mean and standard deviation*\\~\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate mean of Money_spent\nPocket_Money_mean <- mean(Pocket_Money$Money_spent)\n\n# Calculate standard deviation of Money_spent\nPocket_Money_sd <- sd(Pocket_Money$Money_spent)\n\ncat(\"Mean money spent:\", Pocket_Money_mean, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMean money spent: 720.9634 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Standard deviation of money spent:\", Pocket_Money_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviation of money spent: 1835.722\n```\n\n\n:::\n:::\n\n\n\n#### *Histograms for the dataset*\\~\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Pocket_Money, aes(x = Money_spent)) + \n  geom_histogram(fill = \"lightblue\", color = \"black\") + \n  labs(title = \"Histogram of Money Spent\", x = \"Money Spent\", y = \"Frequency\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(Pocket_Money$Money_spent), \n     main = \"Density Plot of Money Spent\", \n     xlab = \"Money Spent\", \n     ylab = \"Density\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(Pocket_Money$Money_spent)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n### *What is our null hypothesis?*\n\n-   There is no significant difference in the average amount of money spent between male and female individuals.\n\n-   This hypothesis suggests that any observed difference in the mean spending between the two genders is due to random chance and not a true difference in the population.\n\n### *Checking for Normality*\\~\n\n#### *Wilcox test*\\~\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(Pocket_Money$Money_spent)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Pocket_Money$Money_spent\nW = 0.34508, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n#### *t-test*\\~\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmale_spending <- Pocket_Money$Money_spent[Pocket_Money$Gender == \"Male\"]\nfemale_spending <- Pocket_Money$Money_spent[Pocket_Money$Gender == \"Female\"]\n\nt_test_result <- t.test(male_spending, female_spending)\n\nprint(t_test_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  male_spending and female_spending\nt = 0.13555, df = 76.468, p-value = 0.8925\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -757.0748  867.6602\nsample estimates:\nmean of x mean of y \n 748.6098  693.3171 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(Pocket_Money$Money_spent)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Pocket_Money$Money_spent\nW = 0.34508, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n#### Permutation:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_Money <- Pocket_Money %>%\n  mutate(Preferance = ifelse(Money_spent > 200, \"High Spender\", \"Low Spender\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a Preferance variable based on a threshold (e.g., high spenders vs. low spenders)\nPocket_Money2 <- Pocket_Money2 %>%\n  mutate(Preferance = ifelse(Money_spent > 200, \"High Spender\", \"Low Spender\"))\n\n# Calculate the mean Money_spent for each Preferance group\ngroup_means <- Pocket_Money2 %>%\n  group_by(Preferance) %>%\n  summarize(mean_Money_spent = mean(Money_spent))\n\n# Calculate the difference in means\nobs_diff_mean <- group_means$mean_Money_spent[1] - group_means$mean_Money_spent[2]\n\nprint(obs_diff_mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1075.936\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_Money2 <- Pocket_Money2 %>%\n  mutate(Preferance = ifelse(Money_spent > 200, \"High Spender\", \"Low Spender\"))\n\n# Calculate the observed difference in means\nobserved_diff <- mean(Pocket_Money2$Money_spent[Pocket_Money2$Preferance == \"High Spender\"]) - \n                 mean(Pocket_Money2$Money_spent[Pocket_Money2$Preferance == \"Low Spender\"])\n\n# Set the number of permutations\nn_permutations <- 1000\n\npermuted_diffs <- numeric(n_permutations)\n\nfor (i in 1:n_permutations) {\n  permuted_data <- Pocket_Money2 %>%\n    mutate(Preferance = sample(Preferance))\n  \n  permuted_diff <- mean(permuted_data$Money_spent[permuted_data$Preferance == \"High Spender\"]) - \n                   mean(permuted_data$Money_spent[permuted_data$Preferance == \"Low Spender\"])\n  \n  permuted_diffs[i] <- permuted_diff\n}\n\n# Plot the null distribution\nhist(permuted_diffs, main = \"Null Distribution of Difference in Means\",\n     xlab = \"Difference in Means\")\nabline(v = observed_diff, col = \"red\") # Add a vertical line for the observed difference\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist_df <- data.frame(Difference = permuted_diffs)\n\n# Plot the null distribution with the observed difference\nggplot(null_dist_df, aes(x = Difference)) +\n  geom_histogram(fill = \"lightblue\", color = \"black\", binwidth = 0.5, alpha = 0.8) +  # Adjust alpha for transparency\n  geom_vline(xintercept = observed_diff, color = \"red\", linetype = \"dashed\", size = 1.2) +  # Adjust line thickness\n  labs(title = \"Null Distribution of Difference in Means\",\n       x = \"Difference in Means\",\n       y = \"Frequency\") +\n  theme_minimal()  \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}